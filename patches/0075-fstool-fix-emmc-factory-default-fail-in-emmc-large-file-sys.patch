From 124f42a333f331e63265349d86dff17cc46238a1 Mon Sep 17 00:00:00 2001
From: "wingate.chi" <wingate.chi@cybertan.com>
Date: Tue, 9 Jul 2024 06:50:43 +0000
Subject: [PATCH] fix emmc factory default fail in emmc large file system

---
 .../001-change-rootfs-size-to-500M.patch      | 24 +++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100755 package/system/fstools/patches/001-change-rootfs-size-to-500M.patch

diff --git a/package/system/fstools/patches/001-change-rootfs-size-to-500M.patch b/package/system/fstools/patches/001-change-rootfs-size-to-500M.patch
new file mode 100755
index 0000000000..a4f4a10333
--- /dev/null
+++ b/package/system/fstools/patches/001-change-rootfs-size-to-500M.patch
@@ -0,0 +1,24 @@
+diff -Naur a/libfstools/common.h b/libfstools/common.h
+--- a/libfstools/common.h	2021-07-29 03:21:49.000000000 +0800
++++ b/libfstools/common.h	2024-04-08 22:54:21.006707009 +0800
+@@ -19,7 +19,7 @@
+ #include "libfstools.h"
+ #include "volume.h"
+ 
+-#define F2FS_MINSIZE		(100ULL * 1024ULL * 1024ULL)
++#define F2FS_MINSIZE		(500ULL * 1024ULL * 1024ULL)  //[CBT] change rootfs size to 500M
+ 
+ int read_uint_from_file(char *dirname, char *filename, unsigned int *i);
+ char *read_string_from_file(const char *dirname, const char *filename, char *buf, size_t bufsz);
+diff -Naur a/libfstools/rootdisk.c b/libfstools/rootdisk.c
+--- a/libfstools/rootdisk.c	2024-04-08 22:44:10.641966000 +0800
++++ b/libfstools/rootdisk.c	2024-04-08 22:49:12.201670412 +0800
+@@ -16,7 +16,7 @@
+ #include <linux/loop.h>
+ 
+ #define ROOTDEV_OVERLAY_ALIGN	(64ULL * 1024ULL)
+-#define F2FS_MINSIZE		(100ULL * 1024ULL * 1024ULL)
++#define F2FS_MINSIZE		(500ULL * 1024ULL * 1024ULL)  //[CBT] change rootfs size to 500M
+ 
+ struct squashfs_super_block {
+ 	uint32_t s_magic;
-- 
2.17.1

